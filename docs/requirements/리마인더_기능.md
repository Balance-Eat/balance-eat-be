# 리마인더 기능

## 개요
사용자가 원하는 시간에 본인이 설정한 알림을 받을 수 있도록 하는 기능입니다.

## DDL
```sql
-- auto-generated definitioncreate table reminder
(
   id                  bigserial
   primary key,
   user_id             bigint                  not null,
   content             varchar(500)            not null,
   send_datetime       timestamp               not null,
   created_at          timestamp default now() not null,
   updated_at          timestamp default now() not null
);


comment on table reminder is '리마인더';
comment on column reminder.content is '리마인더 내용';
comment on column reminder.send_datetime is '발송 시각 (ISO 8601 date-time 형식)';
```

---

## 1. 리마인더 생성

### 요구사항
- 사용자는 리마인더 내용과 발송 시각을 설정하여 새로운 리마인더를 생성할 수 있어야 한다.
- 리마인더 내용은 최대 500자까지 입력 가능하다.
- 발송 시각은 ISO 8601 date-time 형식으로 입력받는다.
- 성공적으로 리마인더가 생성되면 생성된 리마인더 정보와 함께 201 상태 코드를 반환해야 한다.

### API Specification

#### 엔드포인트
```
POST /v1/reminders
```

#### 요청 명세
##### 요청 헤더 (Request Header)
- `X-USER-ID`: {userId} (Long, 필수)

##### 요청 바디 (Request Body)
```json
{
  "content": "아침 식사 기록하기",
  "sendDatetime": "2025-12-02T09:00:00"
}
```

**필드 설명**:
- `content` (string, 필수): 리마인더 내용 (최대 500자)
- `sendDatetime` (string, 필수): 발송 시각 (ISO 8601 date-time 형식, 예: "2025-12-02T09:00:00")

#### 응답 명세
##### 응답 바디 (Response Body)
```json
{
  "status": "SUCCESS",
  "message": "성공",
  "data": {
    "id": 1,
    "userId": 123,
    "content": "아침 식사 기록하기",
    "sendDatetime": "2025-12-02T09:00:00",
    "createdAt": "2025-12-02T10:00:00.123456",
    "updatedAt": "2025-12-02T10:00:00.123456"
  },
  "serverDatetime": "2025-12-02T10:00:00.123456"
}
```

---

## 2. 리마인더 수정

### 요구사항
- 사용자는 자신이 생성한 리마인더의 내용과 발송 시각을 수정할 수 있어야 한다.
- 수정 시 내용과 발송 시각 중 하나 이상의 필드가 변경되어야 한다.
- 다른 사용자의 리마인더는 수정할 수 없다.

### API Specification

#### 엔드포인트
```
PATCH /v1/reminders/{reminderId}
```

#### 요청 명세
##### 요청 헤더 (Request Header)
- `X-USER-ID`: {userId} (Long, 필수)

##### 경로 파라미터 (Path Parameter)
- `reminderId`: 수정할 리마인더 ID (Long, 필수)

##### 요청 바디 (Request Body)
```json
{
  "content": "아침 식사 및 간식 기록하기",
  "sendDatetime": "2025-12-02T09:30:00"
}
```

**필드 설명**:
- `content` (string, 선택): 수정할 리마인더 내용 (최대 500자)
- `sendDatetime` (string, 선택): 수정할 발송 시각 (ISO 8601 date-time 형식)

#### 응답 명세
##### 응답 바디 (Response Body)
```json
{
  "status": "SUCCESS",
  "message": "성공",
  "data": {
    "id": 1,
    "userId": 123,
    "content": "아침 식사 및 간식 기록하기",
    "sendDatetime": "2025-12-02T09:30:00",
    "createdAt": "2025-12-02T10:00:00.123456",
    "updatedAt": "2025-12-02T11:00:00.123456"
  },
  "serverDatetime": "2025-12-02T11:00:00.123456"
}
```

---

## 3. 리마인더 삭제

### 요구사항
- 사용자는 자신이 생성한 리마인더를 삭제할 수 있어야 한다.
- 다른 사용자의 리마인더는 삭제할 수 없다.
- 삭제된 리마인더는 DB에서 완전히 제거된다 (하드 삭제).
- 성공적으로 삭제되면 204 상태 코드를 반환해야 한다.

### API Specification

#### 엔드포인트
```
DELETE /v1/reminders/{reminderId}
```

#### 요청 명세
##### 요청 헤더 (Request Header)
- `X-USER-ID`: {userId} (Long, 필수)

##### 경로 파라미터 (Path Parameter)
- `reminderId`: 삭제할 리마인더 ID (Long, 필수)

#### 응답 명세
##### 응답 바디 (Response Body)
```
204 No Content
```

---

## 4. 리마인더 목록 조회

### 요구사항
- 사용자는 자신이 생성한 모든 리마인더 목록을 페이징 처리하여 조회할 수 있어야 한다.
- 목록은 발송 시각 기준 오름차순으로 정렬되어 반환된다.
- 페이징 처리를 통해 한 번에 조회할 개수를 제한할 수 있다.

### API Specification

#### 엔드포인트
```
GET /v1/reminders
```

#### 요청 명세
##### 요청 헤더 (Request Header)
- `X-USER-ID`: {userId} (Long, 필수)

##### 쿼리 파라미터 (Query Parameters)
- `page` (int, 선택): 페이지 번호 (0부터 시작, 기본값: 0)
- `size` (int, 선택): 페이지 크기 (기본값: 20)
- `sort` (string, 선택): 정렬 기준 (기본값: "sendDatetime,asc")

#### 응답 명세
##### 응답 바디 (Response Body)
```json
{
  "status": "SUCCESS",
  "message": "성공",
  "data": {
    "totalItems": 3,
    "currentPage": 0,
    "itemsPerPage": 20,
    "items": [
      {
        "id": 1,
        "content": "아침 식사 기록하기",
        "sendDatetime": "2025-12-02T09:00:00",
        "createdAt": "2025-12-02T10:00:00.123456",
        "updatedAt": "2025-12-02T10:00:00.123456"
      },
      {
        "id": 2,
        "content": "점심 식사 기록하기",
        "sendDatetime": "2025-12-02T13:00:00",
        "createdAt": "2025-12-02T10:05:00.123456",
        "updatedAt": "2025-12-02T10:05:00.123456"
      },
      {
        "id": 3,
        "content": "저녁 식사 기록하기",
        "sendDatetime": "2025-12-02T19:00:00",
        "createdAt": "2025-12-02T10:10:00.123456",
        "updatedAt": "2025-12-02T15:00:00.123456"
      }
    ]
  },
  "serverDatetime": "2025-12-02T16:00:00.123456"
}
```

---

## 5. 리마인더 상세 조회

### 요구사항
- 사용자는 특정 리마인더의 상세 정보를 조회할 수 있어야 한다.
- 다른 사용자의 리마인더는 조회할 수 없다.

### API Specification

#### 엔드포인트
```
GET /v1/reminders/{reminderId}
```

#### 요청 명세
##### 요청 헤더 (Request Header)
- `X-USER-ID`: {userId} (Long, 필수)

##### 경로 파라미터 (Path Parameter)
- `reminderId`: 조회할 리마인더 ID (Long, 필수)

#### 응답 명세
##### 응답 바디 (Response Body)
```json
{
  "status": "SUCCESS",
  "message": "성공",
  "data": {
    "id": 1,
    "userId": 123,
    "content": "아침 식사 기록하기",
    "sendDatetime": "2025-12-02T09:00:00",
    "createdAt": "2025-12-02T10:00:00.123456",
    "updatedAt": "2025-12-02T10:00:00.123456"
  },
  "serverDatetime": "2025-12-02T16:00:00.123456"
}
```

---

## 에러 응답

### 공통 에러 케이스

#### 1. 권한이 없는 경우 & 리마인더를 찾을 수 없는 경우
```json
{
  "status": "ERROR",
  "message": "존재하지 않는 리마인더입니다.",
  "data": null,
  "serverDatetime": "2025-12-02T16:00:00.123456"
}
```
**HTTP Status Code**: 404

#### 2. 유효하지 않은 요청 데이터
```json
{
  "status": "ERROR",
  "message": "리마인더 내용은 500자를 초과할 수 없습니다.",
  "data": null,
  "serverDatetime": "2025-12-02T16:00:00.123456"
}
```
**HTTP Status Code**: 400

#### 3. 유효하지 않은 날짜 형식
```json
{
  "status": "ERROR",
  "message": "발송 시각은 ISO 8601 date-time 형식이어야 합니다.",
  "data": null,
  "serverDatetime": "2025-12-02T16:00:00.123456"
}
```
**HTTP Status Code**: 400

---

## 비즈니스 규칙

1. **발송 시각 형식**: ISO 8601 date-time 형식으로 입력받고 저장 (예: "2025-12-02T09:00:00")
   - 초단위는 무조건 00으로 설정
2. **내용 길이 제한**: 최대 500자
3. **권한 검증**: 모든 API에서 요청한 사용자와 리마인더 소유자가 일치하는지 확인
4. **정렬 순서**: 목록 조회 시 sendDatetime 기준 오름차순 정렬
5. **페이징**: 기본 페이지 크기 20, 최대 크기 제한 없음
6. **삭제 방식**: 하드 삭제 (DB에서 완전히 제거)